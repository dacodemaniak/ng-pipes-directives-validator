<h1>{{ 'title' | translate }}</h1>

<ng-container *ngIf="persons.length">
  <div>
    <div class="sorter">
      <span
        [ngClass]="{'up': true, 'is-active': sortedCol.sortedCol==='lastName' && sortedCol.direction==='asc'}">
      </span>
      <span
        [appSort]="persons"
        data-order="desc"
        data-name="lastName"
        (currentSortCol)="setCurrentSortCol($event)"
        [ngClass]="{'label': true, 'is-active': sortedCol.sortedCol==='lastName'}"
        >Sort on name</span>
        <span [ngClass]="{'down': true, 'is-active': sortedCol.sortedCol==='lastName' && sortedCol.direction==='desc'}"></span>
    </div>

    <div class="sorter">
      <span [ngClass]="{'up': true, 'is-active': sortedCol.sortedCol==='firstName' && sortedCol.direction==='asc'}"></span>
      <span
        [appSort]="persons"
        data-order="desc"
        data-name="firstName"
        (currentSortCol)="setCurrentSortCol($event)"
        [ngClass]="{'label': true, 'is-active': sortedCol.sortedCol==='firstName'}"
      >Sort on firstname</span>
      <span [ngClass]="{'down': true, 'is-active': sortedCol.sortedCol==='firstName' && sortedCol.direction==='desc'}"></span>
    </div>
</div>
  <div class="card" *ngFor="let person of persons" (click)="loadPerson(person)">
    <p>
      <span class="my-badge">
        {{ person | initials: {whole: true} | uppercase }}
      </span>
      {{ person.firstName }} {{ person.lastName }}
    </p>
  </div>
</ng-container>

<ng-container *ngIf="person && person !== undefined else noPerson;">
  <div class="one-person-card">
    <p>
      <span class="my-badge">
        {{ person | initials | uppercase }}
      </span>
      {{ person.firstName }} {{ person.lastName }}
    </p>
  </div>
</ng-container>

<ng-template #noPerson>
  Click on a card to load a Person
</ng-template>


<!-- Creation form goes here -->
<form [formGroup]="personForm">
  <div appFormField class="form-group">
    <input appIsRequired appMaterialLike type="text" formControlName="lastName" placeholder="Your name..." required  [mark]="'(*)'">
    <div class="error" *ngIf="c.lastName.touched || c.lastName.dirty && c.lastName.errors">
      <div *ngIf="c.lastName.hasError('alreadyExists')">
        {{ personForm.controls.lastName.value }} is already taken, choose another one
      </div>
    </div>
  </div>
  <div class="form-group">
    <input type="text" formControlName="firstName" placeholder="Your firstname...">
  </div>
  <div class="form-group">
    <input type="email" formControlName="email" placeholder="Your email..."  appIsRequired [mark]="'(*)'">
  </div>
  <div class="form-group">
    <input type="email" formControlName="confirmEmail" placeholder="Confirm your email..."  appIsRequired [mark]="'(*)'">
    <div *ngIf="personForm.hasError('emailMustMatch')" id="email-must-match-error">
      emails does not match
    </div>
  </div>
  <!--
  <div class="form-group">
    <input [type]="passwordState ? 'password' : 'text'" formControlName="password" placeholder="Choose a password...">
    <span (click)="passwordState = !passwordState">{{ passwordState ? 'Show' : 'Hide' }}</span>
  </div>
  -->
  <div class="form-group">
    <input
      type="password"
      formControlName="password"
      placeholder="Choose password"
      appShowHidePassword
      [mode]="'icon'"
      (isHideMode)="toggleConfirmPassword($event)"
      appIsRequired [mark]="'(*)'">
  </div>

  <div [ngClass]="{'form-group': true, 'd-none': !passwordState}">
    <input type="password" formControlName="confirmPassword" placeholder="Confirm your password..."  appIsRequired [mark]="'(*)'">
    <div *ngIf="personForm.hasError('passwordMustMatch')">
      Passwords does not match
    </div>
  </div>
  <button [disabled]="personForm.invalid">Create</button>
</form>
